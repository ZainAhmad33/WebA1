<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Job Application Form</title>
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div id="formDataDisplay">
    <br>
    <button class="btn btn-primary" onclick="goBack()">Go Back</button>
  <br>
    <h3>Applications Data</h3>
  <br>
  <table id="myTable" class="table table-hover" style="text-align: center;">
    <tbody>
    </tbody>
  </table>
</div>
  <div class="container" id="formContainer">
    <br>
    <h2>Job Application Form</h2>
    <form id="myForm">
      <fieldset>
        <legend>Personal Information:</legend>
        <div class="form-group">
            <label for="firstName">Name</label>
            <div class="form-row">
                <div class="form-group col-md-6">
                    <input type="text" class="form-control" id="firstName" placeholder="First Name">
                    <label id="firstNameInvalid" class="invalid-feedback" style="display: none;">Cannot be empty or contain special characters and numbers</label>
                </div>
                <div class="form-group col-md-6">
                    <input type="text" class="form-control" id="lastName" placeholder="Last Name">
                    <label id="lastNameInvalid" class="invalid-feedback" style="display: none;">Cannot be empty or contain special characters and numbers</label>
                </div>
            </div>
            <label for="contactInfo">Contact Information</label>
            <div class="form-row">
                <div class="form-group col-md-6">
                    <input type="tel" class="form-control" id="contactInfo" placeholder="Phone Number">
                    <label id="contactInfoInvalid" class="invalid-feedback" style="display: none;">Cannot be empty and Follow correct format: 03XXXXXXXXX</label>
                </div>
                <div class="form-group col-md-6">
                    <input type="email" class="form-control" id="email" placeholder="Email Address">
                    <label id="emailInvalid" class="invalid-feedback" style="display: none;">Incorrect email format or empty</label>
                </div>
            </div>
        </div>
        <div class="form-group">
          <label for="street">Address</label>
          <input type="text" class="form-control" id="street" placeholder="Street">
          <label id="streetInvalid" class="invalid-feedback" style="display: none;">Cannot be empty</label>
          <input type="text" class="form-control mt-2" id="city" placeholder="City">
          <label id="cityInvalid" class="invalid-feedback" style="display: none;">Cannot be empty</label>
          <br>
          <div class="form-row">
            <div class="form-group col-md-6">
              <input type="text" class="form-control" id="state" placeholder="State">
              <label id="stateInvalid" class="invalid-feedback" style="display: none;">Cannot be empty</label>
            </div>
            <div class="form-group col-md-6">
              <input type="text" class="form-control" id="zip" placeholder="ZIP Code">
            </div>
          </div>
        </div>
      </fieldset>

      <fieldset>
        <legend>Resume and Cover Letter:</legend>
        <div class="form-group">
          <label for="resume" class="form-label mt-4">Upload Resume</label>
          <input type="file" class="form-control-file" id="resume">
          <label id="resumeInvalid" class="invalid-feedback" style="display: none;">No resume selected</label>
        </div>
        <div class="form-group">
          <label for="coverLetter">Cover Letter</label>
          <textarea class="form-control" id="coverLetter" rows="4"></textarea>
        </div>
      </fieldset>

      <fieldset>
        <legend>Education:</legend>
        <div class="form-group">
          <label for="educationLevel">Highest Level of Education Attained</label>
          <input type="text" class="form-control" id="educationLevel">
          <label id="educationLevelInvalid" class="invalid-feedback" style="display: none;">Cannot be empty</label>
        </div>
        <div class="form-group">
          <label for="schoolName">Name of School/University</label>
          <input type="text" class="form-control" id="schoolName">
          <label id="schoolNameInvalid" class="invalid-feedback" style="display: none;">Cannot be empty</label>
        </div>
        <div class="form-row">
          <div class="form-group col-md-6">
            <label for="major">Major/Area of Study</label>
            <input type="text" class="form-control" id="major">
            <label id="majorInvalid" class="invalid-feedback" style="display: none;">Cannot be empty</label>
          </div>
          <div class="form-group col-md-6">
            <label for="gradYear">Graduation Year</label>
            <input type="month" class="form-control" id="gradYear">
            <label id="gradYearInvalid" class="invalid-feedback" style="display: none;">Cannot be empty</label>
          </div>
        </div>
      </fieldset>

      <fieldset>
        <legend>Employment History:</legend>
        <div class="form-group">
          <label for="jobTitles">Previous Job Titles</label>
          <input type="text" class="form-control" id="jobTitles">
        </div>
        <div class="form-group">
          <label for="companyNames">Company Names</label>
          <input type="text" class="form-control" id="companyNames">
        </div>
        <div class="form-row">
          <div class="form-group col-md-6">
            <label for="employmentDates">Employment Dates</label>
            <input type="text" class="form-control" id="employmentDates">
          </div>
          <div class="form-group col-md-6">
            <label for="jobResponsibilities">Job Responsibilities</label>
            <textarea class="form-control" id="jobResponsibilities" rows="4"></textarea>
          </div>
        </div>
      </fieldset>

      <fieldset>
        <legend>Skills:</legend>
        <div class="form-group">
          <label for="relevantSkills">Relevant Skills</label>
          <input type="text" class="form-control" id="relevantSkills">
        </div>
        <div class="form-group">
          <label for="certifications">Certifications</label>
          <input type="text" class="form-control" id="certifications">
        </div>
      </fieldset>

      <fieldset>
        <legend>Availability:</legend>
        <div class="form-group">
          <label for="startDate">Start Date</label>
          <input type="date" class="form-control" id="startDate">
          <label id="startDateInvalid" class="invalid-feedback" style="display: none;">Cannot be empty</label>
        </div>
        <div class="form-group">
          <label for="workSchedule">Preferred Work Schedule</label>
          <input type="text" class="form-control" id="workSchedule">
        </div>
        <div class="form-group">
          <label for="relocate">Willingness to Relocate</label>
          <select class="form-control" id="relocate">
            <option>Yes</option>
            <option>No</option>
          </select>
        </div>
      </fieldset>

      <fieldset>
        <legend>References:</legend>
        <div class="form-group">
          <label for="referenceName">Reference Name</label>
          <input type="text" class="form-control" id="referenceName">
        </div>
        <div class="form-group">
          <label for="referenceContact">Reference Contact Information</label>
          <input type="tel" class="form-control" id="referenceContact">
        </div>
        <div class="form-group">
          <label for="relationship">Relationship to Applicant</label>
          <input type="text" class="form-control" id="relationship">
        </div>
      </fieldset>

      <fieldset>
        <legend>Additional Questions:</legend>
        <div class="form-group">
          <label for="whyWorkHere">Why do you want to work for this company?</label>
          <textarea class="form-control" id="whyWorkHere" rows="4"></textarea>
        </div>
      </fieldset>

      <fieldset>
        <legend>Consent and Agreement:</legend>
        <div class="form-group form-check">
          <input type="checkbox" class="form-check-input" id="termsAgree">
          <label class="form-check-label" for="termsAgree">I agree to the terms and conditions</label>
          <label id="termsAgreeInvalid" class="invalid-feedback" style="display: none;">Cannot be unchecked</label>
        </div>
        <div class="form-group form-check">
          <input type="checkbox" class="form-check-input" id="privacyPolicyAck">
          <label class="form-check-label" for="privacyPolicyAck">I acknowledge the Privacy Policy</label>
          <label id="privacyPolicyAckInvalid" class="invalid-feedback" style="display: none;">Cannot be unchecked</label>
        </div>
      </fieldset>

      <button type="submit" class="btn btn-primary">Submit</button>
    </form>
  </div>
</body>
</html>
<script>
    debugger;
    var idToLabel = {
        "firstName" : "First Name",
        "lastName" : "Last Name",
        "contactInfo" : "Contact Number",
        "email" : "Email",
        "street" : "Street",
        "city" : "City",
        "state" : "State",
        "zip" : "ZIP Code",
        "resume" : "Resume",
        "coverLetter" : "Cover Letter",
        "educationLevel" : "Highest Level of Education Attained",
        "schoolName" : "Name of Shcool/University",
        "major" : "FMajor/Area of Study",
        "gradYear" : "Graduation Year",
        "jobTitle" : "Previous Job Titles",
        "companyNames" : "Company Names",
        "employmentDates" : "Employment Dates",
        "jobResponsibilities" : "Job Responsibilities",
        "relevantSkills" : "Relevant Skills",
        "certifications" : "Certifications",
        "startDate" : "Start Date",
        "workSchedule" : "Preferred Work Schedule",
        "relocate" : "Willingness to Relocate",
        "referenceName" : "Reference Name",
        "referenceContact" : "Reference Contact",
        "relationship" : "Relationship to Applicant",
        "whyWorkHere" : "Why work for this company",
        "termsAgree" : "Agree Terms and Conditions",
        "privacyPolicyAck" : "Acknowledge Privacy Policy",
    }
    var tblDiv = document.getElementById('formDataDisplay')
    tblDiv.style.display = 'none';
    var formDiv = document.getElementById('formContainer')

    var applications = []
    function markInvalid(key){
        if (!document.getElementById(key).classList.contains('is-invalid')){
            document.getElementById(key).classList.add('is-invalid')
        }
    }
    function performValidation(data){
        debugger;
        let rValue = true;
        for (let key in data){
            if (data[key] == "" || data[key] == false){
                if (!!document.getElementById(key + 'Invalid')){
                    document.getElementById(key + 'Invalid').style = 'block'
                    markInvalid(key)
                    rValue = false
                }
            }
            else{
                if (key == "firstName" || key == "lastName"){
                    if(/^[a-zA-Z\s]+$/.test(data[key]) == false){
                        if (!!document.getElementById(key + 'Invalid')){
                            document.getElementById(key + 'Invalid').style = 'block'
                            markInvalid(key)
                            rValue = false
                        }
                    }
                    else{
                        if (!!document.getElementById(key + 'Invalid')){
                        document.getElementById(key + 'Invalid').style = 'none'
                        document.getElementById(key).classList.remove('is-invalid')
                    }
                    }
                }
                else if (key == "contactInfo"){
                    if(/^03\d{9}$/.test(data[key]) == false){
                        if (!!document.getElementById(key + 'Invalid')){
                            document.getElementById(key + 'Invalid').style = 'block'
                            markInvalid(key)
                            rValue = false
                        }
                    }
                    else{
                        if (!!document.getElementById(key + 'Invalid')){
                        document.getElementById(key + 'Invalid').style = 'none'
                        document.getElementById(key).classList.remove('is-invalid')
                    }
                    }
                }
                else if (key == "email"){
                    if(/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/.test(data[key]) == false){
                        if (!!document.getElementById(key + 'Invalid')){
                            document.getElementById(key + 'Invalid').style = 'block'
                            markInvalid(key)
                            rValue = false
                        }
                    }
                    else{
                        if (!!document.getElementById(key + 'Invalid')){
                        document.getElementById(key + 'Invalid').style = 'none'
                        document.getElementById(key).classList.remove('is-invalid')
                    }
                    }
                }
                else if (key == "privacyPolicyAck" || key == "termsAgree"){
                    if(!data[key]){
                        if (!!document.getElementById(key + 'Invalid')){
                            document.getElementById(key + 'Invalid').style = 'block'
                            markInvalid(key)
                            
                            rValue = false
                        }
                        
                    }
                    else{
                        if (!!document.getElementById(key + 'Invalid')){
                        document.getElementById(key + 'Invalid').style = 'none'
                        document.getElementById(key).classList.remove('is-invalid')
                    }
                    }
                }
                else{
                    if (!!document.getElementById(key + 'Invalid')){
                        document.getElementById(key + 'Invalid').style = 'none'
                        document.getElementById(key).classList.remove('is-invalid')
                    }
                }
            }
        }
        return rValue
    }

    let myform = document.getElementById('myForm')
    myform.addEventListener('submit', function(e){
        debugger
        e.preventDefault()
        const form = e.target;
        const data = {};
        for (let i=0; i < form.elements.length; i++) {
            const elem = form.elements[i];
            if (elem.id != ""){
                if (elem.id == "resume"){
                    data[elem.id] = elem.files[0].name;
                }
                else{
                    data[elem.id] = elem.value
                }
            }
        }

        data['termsAgree'] = document.getElementById('termsAgree').checked
        data['privacyPolicyAck'] = document.getElementById('privacyPolicyAck').checked
        
        if (performValidation(data)){
            applications.push(data)
            populateTable()
            formDiv.style.display = 'none';
            tblDiv.style.display = 'block';
        }
    });

    function populateTable(){
        debugger;
        var table = document.getElementById("myTable");
        var tbody = table.getElementsByTagName("tbody")[0];
        tbody.innerHTML = ""; 

        for (let i = 0; i < applications.length; i++){
            var row = document.createElement("tr");
            var fieldCell = document.createElement("td");
            fieldCell.colSpan = 2
            fieldCell.textContent = "Application " + (i+1).toString();
            fieldCell.style.fontSize = "24px"
            fieldCell.style.fontWeight = "500px"
            fieldCell.style.color = "white"
            fieldCell.style.backgroundColor = "black"
            row.appendChild(fieldCell);
            tbody.appendChild(row);

            let data = applications[i]
            for (let key in data){
                if (data[key] != ""){
                    addRowToTable(tbody, idToLabel[key], data[key]);
                }
            }

        }
    }

    function goBack(){

        formDiv.style.display = 'block';
        tblDiv.style.display = 'none';
    }

  function addRowToTable(tableBody, field, value) {
    var row = document.createElement("tr");
    var fieldCell = document.createElement("td");
    fieldCell.textContent = field;
    var valueCell = document.createElement("td");
    valueCell.textContent = value;
    row.appendChild(fieldCell);
    row.appendChild(valueCell);
    tableBody.appendChild(row);
  }
</script> 
